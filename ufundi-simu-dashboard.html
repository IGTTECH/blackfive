<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ufundi Simu (Phone Repairing)</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>


>
  

  <section class="dashboard-section">
    <div class="dashboard-content">
      <div class="text-side">
        <h2>Ufundi Simu (Phone Repairing)</h2>
        <details>
          <summary>Jifunze kutengeneza simu zako...</summary>
          <p>Ufundi simu unahusisha matengenezo ya vifaa vya simu za mkononi.
Utajifunza jinsi ya kuchunguza matatizo, kubadilisha skrini, na kurekebisha matatizo ya programu.
Kozi hii inalenga wanafunzi wa Kiswahili wanaotaka taaluma ya ufundi simu.</p>
        </details>
      </div>
      <div class="image-side">
        <img src="assets/images/placeholder.png" alt="Course image">
      </div>
    </div>

    <section class="dashboard-section">
    <div class="dashboard-content">
      <div class="text-side">
        <h2>Ufundi Simu (Phone Repairing)</h2>
        <details>
          <summary>Jifunze kutengeneza simu zako...</summary>
          <p>Ufundi simu unahusisha matengenezo ya vifaa vya simu za mkononi.
Utajifunza jinsi ya kuchunguza matatizo, kubadilisha skrini, na kurekebisha matatizo ya programu.
Kozi hii inalenga wanafunzi wa Kiswahili wanaotaka taaluma ya ufundi simu.</p>
        </details>
      </div>
      <div class="image-side">
        <img src="assets/images/placeholder.png" alt="Course image">
      </div>
    </div>

      <section class="dashboard-section">
    <div class="dashboard-content">
      <div class="text-side">
        <h2>Ufundi Simu (Phone Repairing)</h2>
        <details>
          <summary>Jifunze kutengeneza simu zako...</summary>
          <p>Ufundi simu unahusisha matengenezo ya vifaa vya simu za mkononi.
Utajifunza jinsi ya kuchunguza matatizo, kubadilisha skrini, na kurekebisha matatizo ya programu.
Kozi hii inalenga wanafunzi wa Kiswahili wanaotaka taaluma ya ufundi simu.</p>
        </details>
      </div>
      <div class="image-side">
        <img src="assets/images/placeholder.png" alt="Course image">
      </div>
    </div>

    <section class="dashboard-section">
    <div class="dashboard-content">
      <div class="text-side">
        <h2>Ufundi Simu (Phone Repairing)</h2>
        <details>
          <summary>Jifunze kutengeneza simu zako...</summary>
          <p>Ufundi simu unahusisha matengenezo ya vifaa vya simu za mkononi.
Utajifunza jinsi ya kuchunguza matatizo, kubadilisha skrini, na kurekebisha matatizo ya programu.
Kozi hii inalenga wanafunzi wa Kiswahili wanaotaka taaluma ya ufundi simu.</p>
        </details>
      </div>
      <div class="image-side">
        <img src="assets/images/placeholder.png" alt="Course image">
      </div>
    </div>    
  </section>

<script type="module">
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import { app } from "./assets/js/firebase-config.js";

const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async (user)=>{
  if(!user){
    window.location.href = 'login.html';
    return;
  }
  await user.getIdToken(true);
  const snap = await getDoc(doc(db, 'users', user.uid));
  if(!snap.exists()){
    await auth.signOut();
    window.location.href = 'login.html';
    return;
  }
  const data = snap.data();
  if(!(data.verified && data.paid)){
    const adminSnap = await getDoc(doc(db, 'admins', user.uid));
    if(!adminSnap.exists()){
      alert('Access denied: verified & paid users only.');
      window.location.href = 'verify.html';
      return;
    }
  }
  // Show welcome message
  const welcome = document.createElement('div');
  welcome.innerText = "Welcome, " + (data.firstName || "") + " " + (data.lastName || "");
  document.body.insertBefore(welcome, document.body.firstChild);
});
</script>


<script type="module">
import { auth, db } from "./src/firebase-config.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

onAuthStateChanged(auth, async (user)=>{
  if(!user){ window.location.href = 'login.html'; return; }
  await user.getIdToken(true);
  const snap = await getDoc(doc(db,'users', user.uid));
  if(!snap.exists()){ await auth.signOut(); window.location.href='login.html'; return; }
  const data = snap.data();
  if(!(data.verified && data.paid)){
    const adminSnap = await getDoc(doc(db,'admins', user.uid));
    if(!adminSnap.exists()){ alert('Access denied: verified & paid users only.'); window.location.href='verify.html'; return; }
  }
  const w = document.createElement('div'); w.innerText = 'Welcome, ' + (data.firstName||'') + ' ' + (data.lastName||''); document.body.insertBefore(w, document.body.firstChild);
});
</script>
</body>

</html>
